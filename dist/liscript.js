!function(e){function r(o){if(t[o])return t[o].exports;var n=t[o]={exports:{},id:o,loaded:!1};return e[o].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};liscript=function(){var slice=[].slice,translations={fn:function(e,r){return"(function("+e.join(",")+"){return "+slice.call(arguments,1).map(tree_to_js).join(",")+"})"},"if":function(e,r,t){return"("+tree_to_js(e)+"?"+tree_to_js(r)+":"+tree_to_js(t)+")"},str:function(){return'"'+slice.call(arguments).join(" ")+'"'},obj:function(){for(var e=1,r=[];e<arguments.length;e+=2)r.push([arguments[e-1],arguments[e]]);return"({"+r.map(function(e){return e[0]+":"+tree_to_js(e[1])}).join(",")+"})"},arr:function(){return"(["+slice.call(arguments).map(tree_to_js).join(",")+"])"},set:function(e,r,t){return"("+tree_to_js(e)+"["+tree_to_js(r)+"]="+tree_to_js(t)+")"},get:function(e,r){return"("+tree_to_js(e)+"["+slice.call(arguments,1).map(tree_to_js).join("][")+"])"},"while":function(e,r){return"(function(){while("+tree_to_js(e)+"){"+tree_to_js(r)+"}})()"},iter:function(e,r){return"(function(obj_){for(var key in obj_){var val=obj_[key];"+tree_to_js(r)+"}})("+tree_to_js(e)+")"},call:function(e,r,t){return"("+tree_to_js(e)+"["+tree_to_js(r)+"]("+slice.call(arguments,2).map(tree_to_js).join(",")+"))"}},operators={def:"=","do":",",and:"&&",or:"||",eq:"===",diff:"!==",sum:"+",sub:"-",mul:"*",div:"/",mod:"%",less:"<",greater:">",less_eq:"<=",greater_eq:">="};for(var op in operators)!function(e){translations[e]=function(){return"("+slice.call(arguments).map(tree_to_js).join(operators[e])+")"}}(op);var macros={defmacro:function defmacro(name,args,body){return eval(tree_to_js(["add_macro",["str",name],["fn",args,body]])),'"macro"'},defreader:function defreader(head,open,close){return eval(tree_to_js(["add_reader",["str",head],["str",open],["str",close]])),'"reader"'}},add_macro=function(e,r){console.log("adding macro ",e,r),macros[e]=r},readers={"(":{close:")"},'"':{close:'"',head:"str"},"[":{close:"]",head:"arr"},"{":{close:"}",head:"obj"}},add_reader=function(e,r,t){readers[r]={close:t,head:e},console.log(readers)},parse_tree=function(e){return function r(t){function o(){i.length>0&&" "!=i&&s.push(i),i=""}function n(e){for(var r in readers)if(e.slice(0,r.length)===r)return{open:r,close:readers[r].close,head:readers[r].head}}for(var a,s=[],i="";e.length>0&&e[0]!=t;e=e.slice(1))(a=n(e))&&'"'!=t?(o(),e=e.slice(a.open.length),s.push((a.head?[a.head]:[]).concat(r(a.close)))):" "==e[0]?o():i+=e[0];return o(),s}()[0]},tree_to_string=function e(r){return"object"!=("undefined"==typeof r?"undefined":_typeof(r))?r:"("+r.map(e).join(" ")+")"},tree_to_js=function r(e){return"object"!=("undefined"==typeof e?"undefined":_typeof(e))?e:macros[e[0]]?r(macros[e[0]].apply(this,e.slice(1))):translations[e[0]]?translations[e[0]].apply(this,e.slice(1)):"("+r(e[0])+"("+e.slice(1).map(function(e){return r(e)}).join(",")+"))"},compile=function(e){return parse_tree("("+e.replace(/[\n\t]/g,"")+")").map(function(e){return tree_to_js(parse_tree(tree_to_string(e)))}).join(";")},evaluate=function evaluate(text){return eval(compile(text))};return{eval:evaluate,compile:compile,add_macro:add_macro,add_reader:add_reader,parse_tree:parse_tree,tree_to_js:tree_to_js,tree_to_string:tree_to_string}}(),module.exports=liscript}]);